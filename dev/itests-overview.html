<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="UTF-8">
      <title>iTests Overview</title>
    <meta name="description" content="Apache TomEE">
    <meta name="author" content="Apache TomEE">
    <meta name="google-translate-customization" content="f36a520c08f4c9-0a04e86a9c075ce9-g265f3196f697cf8f-10">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="./../resources/css/bootstrap.css" rel="stylesheet">
    <link href="./../resources/css/prettify.css" rel="stylesheet">
    <link href="./../resources/css/bootstrap-mods.css" rel="stylesheet">
    <link href="./../resources/css/main.css" rel="stylesheet">

    <script type="text/javascript">
        var t = encodeURIComponent(document.title.replace(/^\s+|\s+$/g,""));
        var u = encodeURIComponent(""+document.URL);
    
      function fbshare () {
          window.open(
                  "http://www.facebook.com/sharer/sharer.php?u="+u,
                  'Share on Facebook',
                  'width=640,height=426');
      };
      function gpshare () {
          window.open(
                  "https://plus.google.com/share?url="+u,
                  'Share on Google+',
                  'width=584,height=385');
      };
      function twshare () {
          window.open(
                  "https://twitter.com/intent/tweet?url="+u+"&text="+t,
                  'Share on Twitter',
                  'width=800,height=526');
      };
      function pinshare () {
          window.open("//www.pinterest.com/pin/create/button/?url="+u+"&media=http%3A%2F%2Ftomee.apache.org%2Fresources%2Fimages%2Ffeather-logo.png&description="+t,
                  'Share on Pinterest',
                  'width=800,height=526');
      };
    </script>

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="./../favicon.ico">
    <link rel="apple-touch-icon" href="./../resources/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="./../resources/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="./../resources/images/apple-touch-icon-114x114.png">

    <script src="./../resources/js/prettify.js" type="text/javascript"></script>
    <script src="./../resources/js/jquery-latest.js"></script>
    <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
    <script src="./../resources/js/common.js"></script>
    <script src="./../resources/js/prettyprint.js"></script>
    <!--script src="//assets.pinterest.com/js/pinit.js" type="text/javascript" async></script//-->
    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-2717626-1']);
      _gaq.push(['_setDomainName', 'apache.org']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </head>

  <body>

    <div class="topbar" data-dropdown="dropdown">
      <div class="fill">
        <div class="container">
          <a class="brand" href="./../index.html">Apache TomEE</a>
          <ul class="nav">
              <li class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                  Apache
                      <b class="caret"></b>
                  </a>
                  <ul class="dropdown-menu">
                     <!-- <li><a href="./../misc/whoweare.html">Who we are?</a></li> -->
                     <!-- <li><a href="./../misc/heritage.html">Heritage</a></li> -->
                     <li><a href="http://www.apache.org">Apache Home</a></li>
                     <!-- <li><a href="./../misc/resources.html">Resources</a></li> -->
                     <li><a href="./../misc/contact.html">Contact</a></li>
                     <li><a href="./../misc/legal.html">Legal</a></li>
                     <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
                     <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
                     <li class="divider"/>
                     <li><a href="http://www.apache.org/security">Security</a></li>
                  </ul>
              </li>
              <li><a href="./../index.html">Home</a></li>
              <li><a href="./../downloads.html">Downloads</a></li>
              <li><a href="./../documentation.html">Documentation</a></li>
              <li><a href="./../examples-trunk/index.html">Examples</a></li>
              <li><a href="./../support.html">Support</a></li>
              <li><a href="./../contribute.html">Contribute</a></li>
              <li><a href="./../security/index.html">Security</a></li>
          </ul>

            <!-- Google CSE Search Box Begins  -->
            <FORM class="pull-right" id="searchbox_010475492895890475512:_t4iqjrgx90" action="http://www.google.com/cse">
                <INPUT type="hidden" name="cx" value="010475492895890475512:_t4iqjrgx90">
                <INPUT type="hidden" name="cof" value="FORID:0">
                <INPUT size="18" width="130" style="width:130px" name="q" type="text" placeholder="Search">
            </FORM>
            <!--<SCRIPT type="text/javascript" src="http://www.google.com/coop/cse/brand?form=searchbox_010475492895890475512:_t4iqjrgx90"></SCRIPT>-->
            <!-- Google CSE Search Box Ends -->
        </div>
      </div>
    </div>

    <div class="container">
    

<div class="page-header">
    <small><a href="./../index.html">Home</a>&nbsp;&raquo&nbsp;<a href="./../dev/">Dev</a></small><br>
    <h1>iTests Overview

        <div style="float: right; position: relative; bottom: -10px; ">
            <a onclick="javascript:gpshare()" class="gp-share sprite" title="Share on Google+">share [gp]</a>
            <a onclick="javascript:fbshare()" class="fb-share sprite" title="Share on Facebook">share [fb]</a>
            <a onclick="javascript:twshare()" class="tw-share sprite" title="Share on Twitter">share [tw]</a>
            <a onclick="javascript:pinshare()" class="pin-share sprite" title="Share on Pinterest">share [pin]</a>
            <a data-toggle="modal" href="#edit" class="edit-page" title="Contribute to this Page">contribute</a>
        </div>
    </h1>
</div>

<p><a name="iTestsOverview-Motivation"></a></p>

<h1>Motivation</h1>

<p>The basic idea behind itests that makes them slightly different than plain
junit tests ran by maven is that it's assumed that there are other systems
(servers, databases, brokers, etc) that need to be started or connected to
before the tests can run.  The tests themselves don't setup the other
systems themselves so that the tests don't become coupled with them and you
can actually swap out various aspects of those systems behind the back of
the tests; server version, protocol implementation, java version, VM
implementation, database provider, operating systems, even using embedded
servers and embedded databases.</p>

<p>The idea came from the tests in OpenEJB that do this.  It took a lot of
work to get them to run as part of the maven build and the itest plugin was
the result.</p>

<p>Definitely give those a look at: 
http://svn.apache.org/viewvc/tomee/tomee/trunk/itests/</p>

<p><a name="iTestsOverview-Pluggingin"></a></p>

<h1>Plugging in</h1>

<p>You can have systems started and stopped before and after the tests in a
number of ways.</p>

<p><a name="iTestsOverview-Inmaven1"></a></p>

<h2>In maven 1</h2>

<p>This series of articles established a basic technique for Container Driven
Testing with Maven and OpenEJB using preGoals and postGoals to do server
and databse setup and teardown before and after Maven runs the unit tests.  <a href="http://www.theserverside.com/articles/article.tss?l=ContainerDrivenTestingSeries">http://www.theserverside.com/articles/article.tss?l=ContainerDrivenTestingSeries</a></p>

<p>This concept evolved from OpenEJB into a reusable maven plugin created by
Dain Sundstrom that gave these integration tests (itests) their own source
directory and added itest:setup and itest:teardown goals to your maven
build rather than just using a preGoal on "test:test" for setup and a
postGoal on "test:test" for teardown.  The advantage to the new goals is
that maven does not call any postGoals on "test:test" if the tests failed;
something the above series of articles hacked around with an odd bit of
jelly code.</p>

<p>The new itest plugin was checked into Geronimo with the expectation that
Geronimo would also use it.  After some time of OpenEJB still being the
only consumer of it, it was moved into the Maven repository where they keep
it in the Maven sandbox. </p>

<p><a href="http://maven.apache.org/plugins-sandbox/itest/">http://maven.apache.org/plugins-sandbox/itest/</a></p>

<p>ActiveMQ later started using the itest plugin and now has a large suite of
their own JMS specific integration tests.</p>

<p><a name="iTestsOverview-Inmaven2"></a></p>

<h2>In maven 2</h2>

<p>The concept of integration tests (itests) has been built into the lifecycle
of maven 2, so it is no longer required to have the itest plugin around to
get the extra "itest:setup" and "itest:teardown" goals.  See this document
for more info:  <a href="http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html</a></p>

<p><a name="iTestsOverview-Injunitsetupandteardown"></a></p>

<h2>In junit setup and teardown</h2>

<p>The ejb tests in particular require you to plug in facades for the server
and the database so the client (the tests) can say "give me an initial
context" or "create these tables i need" in a generic way.  It's assumed
that those systems were setup and guaranteed in working state in the itest
setup phase.  It's also guaranteed that the server and database facades
know how to contact the server or database to carry out the "give me an
initial context" and "create these tables" calls.</p>

<p>Here are some implementations of the database provider for reference:
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/AxionTestDatabase.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/DerbyTestDatabase.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/InstantDbTestDatabase.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/PostgreSqlTestDatabase.java</p>

<p>Here are some implementations for the server facades:
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/CorbaTestServer.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/RemoteTestServer.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/IvmTestServer.java
  -
http://cvs.openejb.org/viewrep/openejb/openejb/modules/itests/src/itest/org/openejb/test/RiTestServer.java</p>

<p>Using the itest concept you could setup any system you need before hand,
then just provide an abstraction of that system to the actual tests.  So
it's not limited to just a server or a database.  You could do queue,
topic, clustering heartbeat agent, directory server, etc.</p>

<p><a name="iTestsOverview-Testingmatrix"></a></p>

<h1>Testing matrix</h1>

<p>Even with just what we have we can get quite far.  In a perfect world, we
would actually test against the full matrix:</p>

<p>Server: Local, Database: Axion
  Server: Local, Database: Derby
  Server: Local, Database: PostgreSQL
  Server: Remote, Database: Axion
  Server: Remote, Database: Derby
  Server: Remote, Database: PostgreSQL
  Server: Corba, Database: Axion
  Server: Corba, Database: Derby
  Server: Corba, Database: PostgreSQL</p>

<p>We had that going for a short while years ago but it was just too much
infrastructure for me to keep running.  It would be nice to get Oracle and
MySQL in that list as well.</p>

<p>In an even more perfect world we'd test against not just different Server
and Database combinations, but JVM versions as well.</p>

<p>Server: Local, Database: Axion, JVM: 1.3
  Server: Local, Database: Axion, JVM: 1.4
  Server: Local, Database: Axion, JVM: 1.5
  Server: Local, Database: Derby, JVM: 1.3
  Server: Local, Database: Derby, JVM: 1.4
  Server: Local, Database: Derby, JVM: 1.5
  Server: Local, Database: PostgreSQL, JVM: 1.3
  Server: Local, Database: PostgreSQL, JVM: 1.4
  Server: Local, Database: PostgreSQL, JVM: 1.5
  Server: Remote, Database: Axion, JVM: 1.3
  Server: Remote, Database: Axion, JVM: 1.4
  Server: Remote, Database: Axion, JVM: 1.5
  Server: Remote, Database: Derby, JVM: 1.3
  Server: Remote, Database: Derby, JVM: 1.4
  Server: Remote, Database: Derby, JVM: 1.5
  Server: Remote, Database: PostgreSQL, JVM: 1.3
  Server: Remote, Database: PostgreSQL, JVM: 1.4
  Server: Remote, Database: PostgreSQL, JVM: 1.5
  Server: Corba, Database: Axion, JVM: 1.3
  Server: Corba, Database: Axion, JVM: 1.4
  Server: Corba, Database: Axion, JVM: 1.5
  Server: Corba, Database: Derby, JVM: 1.3
  Server: Corba, Database: Derby, JVM: 1.4
  Server: Corba, Database: Derby, JVM: 1.5
  Server: Corba, Database: PostgreSQL, JVM: 1.3
  Server: Corba, Database: PostgreSQL, JVM: 1.4
  Server: Corba, Database: PostgreSQL, JVM: 1.5</p>

<p>If you add JVM vendors (Sun, IBM, Apple, BEA) to the list, the combinations
goes up to like 109.  Throw on OS implementations and you get an insane
number of test runs to complete.</p>




        <div id="edit" class="modal hide fade in" style="display: none; ">
            <div class="modal-header">
                <a class="close" data-dismiss="modal">x</a>

                <h3>Thank you for contributing to the documentation!</h3>
            </div>
            <div class="modal-body">
                <h4>Any help with the documentation is greatly appreciated.</h4>
                <p>All edits are reviewed before going live, so feel free to do much more than fix typos or links.  If you see a page that could benefit from an entire rewrite, we'd be thrilled to review it.  Don't be surprised if we like it so much we ask you for help with other pages :)</p>
                <small>NOTICE: unless indicated otherwise on the pages in question, all editable content available from apache.org is presumed to be licensed under the Apache License (AL) version 2.0 and hence all submissions to apache.org treated as formal Contributions under the license terms.</small>
                <!--[if gt IE 6]>
                <h4>Internet Explorer Users</h4>
                <p>If you are not an Apache committer, click the Yes link and enter a <i>anonymous</i> for the username and leave the password empty</p>
                <![endif]-->

            </div>
            <div class="modal-footer">
                Do you have an Apache ID?
                <a href="javascript:void(location.href='https://cms.apache.org/redirect?uri='+escape(location.href))" class="btn">Yes</a>
                <a href="javascript:void(location.href='https://anonymous:@cms.apache.org/redirect?uri='+escape(location.href))" class="btn">No</a>
            </div>
        </div>
        <script src="./../resources/js/bootstrap-modal.js"></script>

        <footer>
            <p>Copyright &copy; 1999-2016 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.
                Apache TomEE, TomEE, Apache, the Apache feather logo, and the Apache TomEE project logo are trademarks of The Apache Software Foundation.
                All other marks mentioned may be trademarks or registered trademarks of their respective owners.</p>
        </footer>

    </div> <!-- /container -->

    <!-- Javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="./../resources/js/bootstrap-dropdown.js"></script>

  </body>
</html>
